<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>jekyll源码观看 - a usr/bin</title>
  <meta name="description" content="jekyll">

  
  <link rel="stylesheet" href="/assets/styles/core.css?v=20220530201651">
  <link rel="stylesheet" href="/assets/styles/fontello.css?v=20220530201651">
  <link rel="stylesheet" href="/assets/styles/highlighting/default.css?v=20220530201651">

  <link rel="canonical" href="http://localhost:4000/source-code/2020/03/31/jekyll-source.html">
  <link rel="alternate" type="application/rss+xml" title="a usr/bin" href="/feed.xml">

  

  
</head>

  <body>

  <main class="page-content" aria-label="Content">
    <div class="wrapper">
      <article class="post" lang="en" itemscope itemtype="http://schema.org/BlogPosting" >

  <header class="post-header">
  <a class="site-title" href="/">a usr/bin</a>
  <h1 class="post-title" itemprop="name headline">jekyll源码观看</h1>
</header>




  <div class="post-content" itemprop="articleBody">
    <h1 id="jekyll">jekyll</h1>

<p>因为我比较喜欢ruby，所以想用jekyll作为博客平台。然后因为在搞emacs所以想用org写文档，然后jekyll官方不支持，所以想自己搞个大大的插件，先从源码看起。</p>

<h2 id="项目结构">项目结构</h2>

<h3 id="组织架构">组织架构</h3>
<p>首先我们看到.github文件夹下的CODEOWNER，分了6个组</p>
<ul>
  <li>build组做核心渲染</li>
  <li>ecosystem组做插件，我主要看这个咯</li>
  <li>stability组做ci</li>
  <li>documentation组写文档</li>
  <li>windows组做windows</li>
  <li>affinity team captions组基本就是大佬管管github配置文件</li>
</ul>

<h3 id="参数">参数</h3>
<p>cli他们自己写了一个库叫mercenary来管理命令行参数，这个具体我就不看了。。。就看看参数</p>
<ul>
  <li>source,s 源码地址，也就是项目地址</li>
  <li>destination,d 目标地址，生成的markdown渲染html就到这里</li>
  <li>safe安全模式</li>
  <li>plugins_dir,p 插件地址</li>
  <li>layouts_dir 布局地址</li>
  <li>profile 个人介绍</li>
</ul>

<h2 id="初始化">初始化</h2>
<p>exe里可以看到mercenary把命令封装的特别好，以至于我都不知道它是怎么跑起来的了，我觉得block里的是初始化，因为我看他最后p.subcommand还在找。</p>

<p>于是直接进入下一步，看lib里的jekyll.rb这个文件，这个里面一堆autoload，我就知道，直接看commands里的代码就对了。</p>

<h2 id="命令">命令</h2>

<p>jekyll的命令还挺好看的，在commands里一眼就看的出来。</p>

<h3 id="build">build</h3>
<p>new和new_theme这种太傻了，没啥看的，然后干啥都得build，先看build。</p>

<p>build在 jekyll/commands/build.rb里，这个文件也是很简单的。init里啥也没有，然后process方法封装了一下就调了build方法。</p>

<p>然后转到site.process方法，这是个啥，我看不懂了，卡壳了。。。</p>


  </div>

  <footer class="post-footer">
    <div class="post-meta">
       <time datetime="2020-03-31T07:31:15+08:00" itemprop="datePublished">Mar 31, 2020</time> 
      
    </div>

    
  </footer>

  
</article>

    </div>
    <script type="text/javascript">
  (function () {
    var resize = function () {
      this.width = 0.5 * (this.naturalWidth || this.width);
    }
    Array.prototype.forEach.call(document.querySelectorAll(".half-size, .retina2x"), function(el) {
      if (el.naturalWidth) {
        resize.call(el);
      } else {
        el.onload = resize;
      }
    });
  })();
</script>

  </main>

  <footer class="site-footer">

  <div class="wrapper">
    <div class="social-links">
      <a class="social-link social-github" href="https://github.com/ppphp">
        <i class="icon-github"></i>
      </a>
      <a class="social-link social-twitter" href="https://twitter.com/nmdshd">
        <i class="icon-twitter"></i>
      </a>
      <a class="social-link social-instagram" href="https://instagram.com/">
        <i class="icon-instagram"></i>
      </a>
      <a class="social-link social-rss" href="/feed.xml" target="_blank">
        <i class="icon-rss"></i>
      </a>
    </div>
    <div class="credits">
      KAGAMI, made with <i class="icon-heart"></i> by Kamikat
    </div>
  </div>

</footer>


</body>

</html>
